{% extends "base.html" %}
{% block content %}






<!-- <center> -->



<!-- </center> -->

<div id="command_bar"></div>

<div id="corpus_desc"></div>


{% include "word_desc.html" %}
{% include "linegraph_v3_spaces.html" %}
{% include "slopegraph.html" %}
{% include "linegraph_v3.html" %}
{% include "field_desc.html" %}
{% include "custom_spaces.html" %}
{% include "word_network.html" %}




<script type="text/javascript" src="/static/word.js"></script>
<script type="text/javascript" src="/socket.io/socket.io.js"></script>
<script type="text/javascript" src="/static/word-client.js"></script>
<script type="text/javascript" src="/static/springy.js"></script>
<script type="text/javascript" src="/static/springyui.js"></script>
<!-- <script type="text/javascript" src="/static/cytoscape.min.js"></script> -->



<canvas id="net_canvas" width="960" height="600" />

</center>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.5.7/shim.min.js"></script>
    <script src="https://unpkg.com/layout-base/layout-base.js"></script>
    <script src="https://unpkg.com/cose-base/cose-base.js"></script> -->
    <script src="/static/cola.min.js" type="text/javascript"></script>

<div id="cy"></div>
<style>
    #cy {
        /*width: 100%;
        height: 100%;
        position: absolute;
        top: 0px;
        left: 0px;*/
    }
</style>


<script>
function status(data) {
	$('#status').prepend(data+'<br/>'); //+$('#status').html());
}
function log(x) {
	status('<< '+x);
}



$(function () {
	var socket = io();



	function analyze_word() {
		$('#status').html('')
		// $('#feedback').html('analyze_word!')
		word=get_word();
		args={'word':word}
		args['n_top']=$('#n_top').val();
		log('get_vectors('+word+')');
		socket.emit('get_vectors', args);
	}

	// prepare page
	// $('#feedback').html('document ready...')
	$('#analyze_word_button').click(function() { analyze_word();});
	$('#analyze_word').bind("enterKey",function(e){ analyze_word(); });
	$('#analyze_word').keyup(function(e){ if(e.keyCode == 13) { $(this).trigger("enterKey");}});


	socket.on('status', function(data){ 
		status(data);
	});

	// client-side response routing
	socket.on('get_most_similar_resp', function(data){
		console.log('got this reply!',data);
		log('received response to get_most_similar()')
    	draw_net(data);

	});

	socket.on('get_vectors_resp', function(data){
		log('received response to get_vectors()')
		
		html=''
    	for (var word in data) {
    		html+='<li>'+word+':'+data[word].slice(0,5).join(' ')+'...'
    	}
    	$('#feedback').html(html)


	});




	// $('#analyze_word').enter();
	analyze_word();
});
</script>

{% endblock %}
