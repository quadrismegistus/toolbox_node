// CRAYONS = [ { "hex": "#EFDECD", "name": "Almond", "rgb": "(239, 222, 205)" }, { "hex": "#CD9575", "name": "Antique Brass", "rgb": "(205, 149, 117)" }, { "hex": "#FDD9B5", "name": "Apricot", "rgb": "(253, 217, 181)" }, { "hex": "#78DBE2", "name": "Aquamarine", "rgb": "(120, 219, 226)" }, { "hex": "#87A96B", "name": "Asparagus", "rgb": "(135, 169, 107)" }, { "hex": "#FFA474", "name": "Atomic Tangerine", "rgb": "(255, 164, 116)" }, { "hex": "#FAE7B5", "name": "Banana Mania", "rgb": "(250, 231, 181)" }, { "hex": "#9F8170", "name": "Beaver", "rgb": "(159, 129, 112)" }, { "hex": "#FD7C6E", "name": "Bittersweet", "rgb": "(253, 124, 110)" }, { "hex": "#000000", "name": "Black", "rgb": "(0,0,0)" }, { "hex": "#ACE5EE", "name": "Blizzard Blue", "rgb": "(172, 229, 238)" }, { "hex": "#1F75FE", "name": "Blue", "rgb": "(31, 117, 254)" }, { "hex": "#A2A2D0", "name": "Blue Bell", "rgb": "(162, 162, 208)" }, { "hex": "#6699CC", "name": "Blue Gray", "rgb": "(102, 153, 204)" }, { "hex": "#0D98BA", "name": "Blue Green", "rgb": "(13, 152, 186)" }, { "hex": "#7366BD", "name": "Blue Violet", "rgb": "(115, 102, 189)" }, { "hex": "#DE5D83", "name": "Blush", "rgb": "(222, 93, 131)" }, { "hex": "#CB4154", "name": "Brick Red", "rgb": "(203, 65, 84)" }, { "hex": "#B4674D", "name": "Brown", "rgb": "(180, 103, 77)" }, { "hex": "#FF7F49", "name": "Burnt Orange", "rgb": "(255, 127, 73)" }, { "hex": "#EA7E5D", "name": "Burnt Sienna", "rgb": "(234, 126, 93)" }, { "hex": "#B0B7C6", "name": "Cadet Blue", "rgb": "(176, 183, 198)" }, { "hex": "#FFFF99", "name": "Canary", "rgb": "(255, 255, 153)" }, { "hex": "#1CD3A2", "name": "Caribbean Green", "rgb": "(28, 211, 162)" }, { "hex": "#FFAACC", "name": "Carnation Pink", "rgb": "(255, 170, 204)" }, { "hex": "#DD4492", "name": "Cerise", "rgb": "(221, 68, 146)" }, { "hex": "#1DACD6", "name": "Cerulean", "rgb": "(29, 172, 214)" }, { "hex": "#BC5D58", "name": "Chestnut", "rgb": "(188, 93, 88)" }, { "hex": "#DD9475", "name": "Copper", "rgb": "(221, 148, 117)" }, { "hex": "#9ACEEB", "name": "Cornflower", "rgb": "(154, 206, 235)" }, { "hex": "#FFBCD9", "name": "Cotton Candy", "rgb": "(255, 188, 217)" }, { "hex": "#FDDB6D", "name": "Dandelion", "rgb": "(253, 219, 109)" }, { "hex": "#2B6CC4", "name": "Denim", "rgb": "(43, 108, 196)" }, { "hex": "#EFCDB8", "name": "Desert Sand", "rgb": "(239, 205, 184)" }, { "hex": "#6E5160", "name": "Eggplant", "rgb": "(110, 81, 96)" }, { "hex": "#CEFF1D", "name": "Electric Lime", "rgb": "(206, 255, 29)" }, { "hex": "#71BC78", "name": "Fern", "rgb": "(113, 188, 120)" }, { "hex": "#6DAE81", "name": "Forest Green", "rgb": "(109, 174, 129)" }, { "hex": "#C364C5", "name": "Fuchsia", "rgb": "(195, 100, 197)" }, { "hex": "#CC6666", "name": "Fuzzy Wuzzy", "rgb": "(204, 102, 102)" }, { "hex": "#E7C697", "name": "Gold", "rgb": "(231, 198, 151)" }, { "hex": "#FCD975", "name": "Goldenrod", "rgb": "(252, 217, 117)" }, { "hex": "#A8E4A0", "name": "Granny Smith Apple", "rgb": "(168, 228, 160)" }, { "hex": "#95918C", "name": "Gray", "rgb": "(149, 145, 140)" }, { "hex": "#1CAC78", "name": "Green", "rgb": "(28, 172, 120)" }, { "hex": "#1164B4", "name": "Green Blue", "rgb": "(17, 100, 180)" }, { "hex": "#F0E891", "name": "Green Yellow", "rgb": "(240, 232, 145)" }, { "hex": "#FF1DCE", "name": "Hot Magenta", "rgb": "(255, 29, 206)" }, { "hex": "#B2EC5D", "name": "Inchworm", "rgb": "(178, 236, 93)" }, { "hex": "#5D76CB", "name": "Indigo", "rgb": "(93, 118, 203)" }, { "hex": "#CA3767", "name": "Jazzberry Jam", "rgb": "(202, 55, 103)" }, { "hex": "#3BB08F", "name": "Jungle Green", "rgb": "(59, 176, 143)" }, { "hex": "#FEFE22", "name": "Laser Lemon", "rgb": "(254, 254, 34)" }, { "hex": "#FCB4D5", "name": "Lavender", "rgb": "(252, 180, 213)" }, { "hex": "#FFF44F", "name": "Lemon Yellow", "rgb": "(255, 244, 79)" }, { "hex": "#FFBD88", "name": "Macaroni and Cheese", "rgb": "(255, 189, 136)" }, { "hex": "#F664AF", "name": "Magenta", "rgb": "(246, 100, 175)" }, { "hex": "#AAF0D1", "name": "Magic Mint", "rgb": "(170, 240, 209)" }, { "hex": "#CD4A4C", "name": "Mahogany", "rgb": "(205, 74, 76)" }, { "hex": "#EDD19C", "name": "Maize", "rgb": "(237, 209, 156)" }, { "hex": "#979AAA", "name": "Manatee", "rgb": "(151, 154, 170)" }, { "hex": "#FF8243", "name": "Mango Tango", "rgb": "(255, 130, 67)" }, { "hex": "#C8385A", "name": "Maroon", "rgb": "(200, 56, 90)" }, { "hex": "#EF98AA", "name": "Mauvelous", "rgb": "(239, 152, 170)" }, { "hex": "#FDBCB4", "name": "Melon", "rgb": "(253, 188, 180)" }, { "hex": "#1A4876", "name": "Midnight Blue", "rgb": "(26, 72, 118)" }, { "hex": "#30BA8F", "name": "Mountain Meadow", "rgb": "(48, 186, 143)" }, { "hex": "#C54B8C", "name": "Mulberry", "rgb": "(197, 75, 140)" }, { "hex": "#1974D2", "name": "Navy Blue", "rgb": "(25, 116, 210)" }, { "hex": "#FFA343", "name": "Neon Carrot", "rgb": "(255, 163, 67)" }, { "hex": "#BAB86C", "name": "Olive Green", "rgb": "(186, 184, 108)" }, { "hex": "#FF7538", "name": "Orange", "rgb": "(255, 117, 56)" }, { "hex": "#FF2B2B", "name": "Orange Red", "rgb": "(255, 43, 43)" }, { "hex": "#F8D568", "name": "Orange Yellow", "rgb": "(248, 213, 104)" }, { "hex": "#E6A8D7", "name": "Orchid", "rgb": "(230, 168, 215)" }, { "hex": "#414A4C", "name": "Outer Space", "rgb": "(65, 74, 76)" }, { "hex": "#FF6E4A", "name": "Outrageous Orange", "rgb": "(255, 110, 74)" }, { "hex": "#1CA9C9", "name": "Pacific Blue", "rgb": "(28, 169, 201)" }, { "hex": "#FFCFAB", "name": "Peach", "rgb": "(255, 207, 171)" }, { "hex": "#C5D0E6", "name": "Periwinkle", "rgb": "(197, 208, 230)" }, { "hex": "#FDDDE6", "name": "Piggy Pink", "rgb": "(253, 221, 230)" }, { "hex": "#158078", "name": "Pine Green", "rgb": "(21, 128, 120)" }, { "hex": "#FC74FD", "name": "Pink Flamingo", "rgb": "(252, 116, 253)" }, { "hex": "#F78FA7", "name": "Pink Sherbet", "rgb": "(247, 143, 167)" }, { "hex": "#8E4585", "name": "Plum", "rgb": "(142, 69, 133)" }, { "hex": "#7442C8", "name": "Purple Heart", "rgb": "(116, 66, 200)" }, { "hex": "#9D81BA", "name": "Purple Mountain's Majesty", "rgb": "(157, 129, 186)" }, { "hex": "#FE4EDA", "name": "Purple Pizzazz", "rgb": "(254, 78, 218)" }, { "hex": "#FF496C", "name": "Radical Red", "rgb": "(255, 73, 108)" }, { "hex": "#D68A59", "name": "Raw Sienna", "rgb": "(214, 138, 89)" }, { "hex": "#714B23", "name": "Raw Umber", "rgb": "(113, 75, 35)" }, { "hex": "#FF48D0", "name": "Razzle Dazzle Rose", "rgb": "(255, 72, 208)" }, { "hex": "#E3256B", "name": "Razzmatazz", "rgb": "(227, 37, 107)" }, { "hex": "#EE204D", "name": "Red", "rgb": "(238,32 ,77 )" }, { "hex": "#FF5349", "name": "Red Orange", "rgb": "(255, 83, 73)" }, { "hex": "#C0448F", "name": "Red Violet", "rgb": "(192, 68, 143)" }, { "hex": "#1FCECB", "name": "Robin's Egg Blue", "rgb": "(31, 206, 203)" }, { "hex": "#7851A9", "name": "Royal Purple", "rgb": "(120, 81, 169)" }, { "hex": "#FF9BAA", "name": "Salmon", "rgb": "(255, 155, 170)" }, { "hex": "#FC2847", "name": "Scarlet", "rgb": "(252, 40, 71)" }, { "hex": "#76FF7A", "name": "Screamin' Green", "rgb": "(118, 255, 122)" }, { "hex": "#9FE2BF", "name": "Sea Green", "rgb": "(159, 226, 191)" }, { "hex": "#A5694F", "name": "Sepia", "rgb": "(165, 105, 79)" }, { "hex": "#8A795D", "name": "Shadow", "rgb": "(138, 121, 93)" }, { "hex": "#45CEA2", "name": "Shamrock", "rgb": "(69, 206, 162)" }, { "hex": "#FB7EFD", "name": "Shocking Pink", "rgb": "(251, 126, 253)" }, { "hex": "#CDC5C2", "name": "Silver", "rgb": "(205, 197, 194)" }, { "hex": "#80DAEB", "name": "Sky Blue", "rgb": "(128, 218, 235)" }, { "hex": "#ECEABE", "name": "Spring Green", "rgb": "(236, 234, 190)" }, { "hex": "#FFCF48", "name": "Sunglow", "rgb": "(255, 207, 72)" }, { "hex": "#FD5E53", "name": "Sunset Orange", "rgb": "(253, 94, 83)" }, { "hex": "#FAA76C", "name": "Tan", "rgb": "(250, 167, 108)" }, { "hex": "#18A7B5", "name": "Teal Blue", "rgb": "(24, 167, 181)" }, { "hex": "#EBC7DF", "name": "Thistle", "rgb": "(235, 199, 223)" }, { "hex": "#FC89AC", "name": "Tickle Me Pink", "rgb": "(252, 137, 172)" }, { "hex": "#DBD7D2", "name": "Timberwolf", "rgb": "(219, 215, 210)" }, { "hex": "#17806D", "name": "Tropical Rain Forest", "rgb": "(23, 128, 109)" }, { "hex": "#DEAA88", "name": "Tumbleweed", "rgb": "(222, 170, 136)" }, { "hex": "#77DDE7", "name": "Turquoise Blue", "rgb": "(119, 221, 231)" }, { "hex": "#FFFF66", "name": "Unmellow Yellow", "rgb": "(255, 255, 102)" }, { "hex": "#926EAE", "name": "Violet (Purple)", "rgb": "(146, 110, 174)" }, { "hex": "#324AB2", "name": "Violet Blue", "rgb": "(50, 74, 178)" }, { "hex": "#F75394", "name": "Violet Red", "rgb": "(247, 83, 148)" }, { "hex": "#FFA089", "name": "Vivid Tangerine", "rgb": "(255, 160, 137)" }, { "hex": "#8F509D", "name": "Vivid Violet", "rgb": "(143, 80, 157)" }, { "hex": "#FFFFFF", "name": "White", "rgb": "(255, 255, 255)" }, { "hex": "#A2ADD0", "name": "Wild Blue Yonder", "rgb": "(162, 173, 208)" }, { "hex": "#FF43A4", "name": "Wild Strawberry", "rgb": "(255, 67, 164)" }, { "hex": "#FC6C85", "name": "Wild Watermelon", "rgb": "(252, 108, 133)" }, { "hex": "#CDA4DE", "name": "Wisteria", "rgb": "(205, 164, 222)" }, { "hex": "#FCE883", "name": "Yellow", "rgb": "(252, 232, 131)" }, { "hex": "#C5E384", "name": "Yellow Green", "rgb": "(197, 227, 132)" }, { "hex": "#FFAE42", "name": "Yellow Orange", "rgb": "(255, 174, 66)" } ]
// COLORS = []
// CRAYONS.forEach(function(crayon) { COLORS.push(crayon['hex']) })

//var COLORS = [ '#E6B333', '#3366E6', '#999966', '#99FF99', '#B34D4D', '#80B300', '#809900', '#E6B3B3', '#6680B3', '#66991A', '#FF99E6', '#CCFF1A', '#FF1A66', '#E6331A', '#33FFCC', '#66994D', '#B366CC', '#4D8000', '#B33300', '#CC80CC', '#66664D', '#991AFF', '#E666FF', '#4DB3FF', '#1AB399', '#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680', '#4D8066', '#809980', '#E6FF80', '#1AFF33', '#999933', '#FF3380', '#CCCC00', '#66E64D', '#4D80CC', '#9900B3', '#E64D66', '#4DB380', '#FF4D4D', '#99E6E6', '#6666FF']

var COLORS10 = ['#e07a43','#c38331','#a4892b','#858c33','#668d42','#488b54','#298766','#008275','#007b80','#137485']
// var COLORS = ['#e07a43','#858c33','#298766','#137485']
// var COLORS = ['#ecd44b','#fb7755','#bb3983','#17378d']
var COLORS = ['#d15b18','#87971e','#0db48b','#27bfe0']



function draw_net(data) {


	// $('#command_bar').html(cmdbar)
	$('#cmdbar_net').show();
	$('#net_canvas').remove()
	$('#canvas_div').html('<canvas id="net_canvas" min-width="600px" width="900px" height="750px" /></div></center>')
	// $('#n_top').bind("enterKey",function(e){ analyze_word(); });
	// $('#n_top').keyup(function(e){ if(e.keyCode == 13) { $(this).trigger("enterKey");}});
	draw_net_springy(data)
}




function draw_nets(data, div_id='networks', div_net_id='net_canvas', div_net_class='net_div') {
	console.log('draw_nets::',data)
	// $('#cmdbar_net').show();
	$('#'+div_id).html('')
	net_titles=[]
	periods=[]
	div_ids=[]
	data.forEach(function(netd,i) {  
		period=netd['period']
		net=netd['netdata']

		// console.log('NET:',i,net)

		if(data.length>1) { nettitle='<h3>Network: '+period+'</h3>' } else { nettitle='' }
		nettitle=''
		periods.push(period)
		if(nettitle!='') { net_titles.push(nettitle) }

		this_net_div_id  = div_net_id + (i+1)
		div_ids.push(this_net_div_id)

		
		// newdivhtml='<div id="'+this_net_div_id+'" class="'+div_net_class+'"><h3>Network: '+period+'</h3> '+nettitle+'</div>'
		newdivhtml='<div id="'+this_net_div_id+'" class="'+div_net_class+'">'+nettitle+'</div>'
		$('#'+div_id).append(newdivhtml)
		
		draw_net_springy(net, this_net_div_id)
		
		if(i>0) { $('#'+this_net_div_id).hide() }
	})

	if(data.length>1) { 
		meta_title = []
		periods.forEach(function(p,i) {
			pdiv = div_ids[i]
			pstr='<a href="javascript:void" onclick="netswitch(\''+pdiv+'\')">'+p+'</a>'
			meta_title.push(pstr)
		})
		meta_title=meta_title.join(' | ')
		$('#'+div_id).prepend('<h3>Periods: '+meta_title+'</h3>')
	}
}


function draw_net_springy(data, div_id, div_class='net_canvas') {
	var canvas_id=div_id+'_canvas'
	$('#'+div_id).append('<canvas id="'+canvas_id+'" class="'+div_class+'" min-width="600px" width="900px" height="750px" />')

	// make a new Graph
	var graph = new Springy.Graph()

	// which nodes are sources
	sources=[]
	data.links.forEach(function(link_d) {
		if(!sources.includes(link_d.source)) { sources.push(link_d.source); }
	});
	console.log(sources)

	id2node={}
	periods_sofar=new Set()
	period2color={}

	data.nodes.sort(function(d1,d2) { 
		p1=d1.id.split('_')[1]
		p2=d2.id.split('_')[1]
		if(p1<p2) { return -1 }
		if(p1>p2) { return 1 }
		return 0
	})
	data.nodes.forEach(function(nd) { periods_sofar.add(nd.period) })

	font_default = '14px Monaco, monospace' //, Courier, Georgia, Garamond, Verdana'    //"Ubuntu Mono", monospace'
	data.nodes.forEach(function(node_d) {
	  id=node_d['id']
	  node_d['label']=node_d['word'][0].toUpperCase() + node_d['word'].slice(1) //node_d['id'][0].toUpperCase() + node_d['id'].slice(1)
	  // node_d['label']=node_d['id'][0].toUpperCase() + node_d['id'].slice(1)
	  // node_d['id'][0].toUpperCase() + node_d['id'].slice(1)
	  // node_d['period']=node_d['label'].split('_')[1]
	  period = node_d['period']

	  if(!(period in period2color) & (period!=undefined)) { period2color[period] = COLORS[Object.keys(period2color).length] }

	  periods_sofar.add(node_d['period'])
	  node_d['font']=font_default
	  node_d['color']='black'

	  console.log('node_d!!',periods_sofar,periods_sofar.size,node_d)

	  if((node_d['period']!=undefined) & (periods_sofar.size>1)) {
	  	// if(!(node_d['period'] in period2color)) {
	  	// 	period2color[node_d['period']] = period2color[node_d['period']]
	  	// }
	  	node_d['label']=node_d['label'].split('_')[0]
	  	node_d['color'] = period2color[period]
	  } else if (sources.includes(id)) {
	  	// node_d['color'] = '#1B4F72'
	  } else {
	  	node_d['font'] = '12' + font_default.slice(2)
	  }

	  id2node[id]=graph.newNode(node_d);
	});

	data.links.forEach(function(link_d) {
	  node1=id2node[link_d['source']];
	  node2=id2node[link_d['target']];
	  // edge_d={'stroke-width':10,'color':'red','opacity':0.25, 'size':10}
	  graph.newEdge(node1, node2, {'weight':link_d['weight']*2});
	});	
	
	// $('#net_canvas').springy({ graph: graph,
	// 	nodeSelected: function(node){
//    		 console.log('Node selected: ' + JSON.stringify(node.data));
//   		}

	// });

	$(function(){
		console.log('canvas_id',canvas_id,'????')
	  var springy = window.springy = $('#'+canvas_id).springy({
	    graph: graph,
	    nodeSelected: function(node){
	      console.log('Node selected: ' + JSON.stringify(node.data));
	    }
	  });
	});
}





function draw_net_d3(data) {

	$('#cy').html('<svg width="960" height="600" id="svg_net"></svg>')

	var svg = d3v4.select("#svg_net"),
	    width = +svg.attr("width"),
	    height = +svg.attr("height");

	var color = d3v4.scaleOrdinal(d3v4.schemeCategory20);

	var simulation = d3v4.forceSimulation()
	    .force("link", d3v4.forceLink().id(function(d) { return d.id; }))
	    .force("charge", d3v4.forceManyBody())
	    .force("center", d3v4.forceCenter(width / 2, height / 2));

	d3v4.entries(data, function(error, graph) {
		console.log('>>',error,graph)
	  if (error) throw error;

	  var link = svg.append("g")
	      .attr("class", "links")
	    .selectAll("line")
	    .data(graph.links)
	    .enter().append("line")
	      .attr("stroke-width", function(d) { return Math.sqrt(d.value); });

	  var node = svg.append("g")
	      .attr("class", "nodes")
	    .selectAll("g")
	    .data(graph.nodes)
	    .enter().append("g")
	    
	  var circles = node.append("circle")
	      .attr("r", 5)
	      .attr("fill", function(d) { return color(d.group); })
	      .call(d3v4.drag()
	          .on("start", dragstarted)
	          .on("drag", dragged)
	          .on("end", dragended));

	  var lables = node.append("text")
	      .text(function(d) {
	        return d.id;
	      })
	      .attr('x', 6)
	      .attr('y', 3);

	  node.append("title")
	      .text(function(d) { return d.id; });

	  simulation
	      .nodes(graph.nodes)
	      .on("tick", ticked);

	  simulation.force("link")
	      .links(graph.links);

	  function ticked() {
	    link
	        .attr("x1", function(d) { return d.source.x; })
	        .attr("y1", function(d) { return d.source.y; })
	        .attr("x2", function(d) { return d.target.x; })
	        .attr("y2", function(d) { return d.target.y; });

	    node
	        .attr("transform", function(d) {
	          return "translate(" + d.x + "," + d.y + ")";
	        })
	  }
	});

	function dragstarted(d) {
	  if (!d3v4.event.active) simulation.alphaTarget(0.3).restart();
	  d.fx = d.x;
	  d.fy = d.y;
	}

	function dragged(d) {
	  d.fx = d3v4.event.x;
	  d.fy = d3v4.event.y;
	}

	function dragended(d) {
	  if (!d3v4.event.active) simulation.alphaTarget(0);
	  d.fx = null;
	  d.fy = null;
	}
}



function draw_net_cola(data) { 

	var width = 960,
        height = 500;

    var color = d3v4.scaleOrdinal(d3v4.schemeCategory20);

    var cola = cola.d3adaptor(d3v4)
        .size([width, height]);

    var svg = d3v4.select("#cy").append("svg")
        .attr("width", width)
        .attr("height", height);

    d3v4.entries(data, function (error, graph) {
    	console.log(error)
    	console.log(graph)

        cola
            .nodes(graph.nodes)
            .links(graph.links)
            .jaccardLinkLengths(40,0.7)
            .start(30);

        var link = svg.selectAll(".link")
            .data(graph.links)
          .enter().append("line")
            .attr("class", "link")
            .style("stroke-width", function (d) { return Math.sqrt(d.value); });

        var node = svg.selectAll(".node")
            .data(graph.nodes)
          .enter().append("circle")
            .attr("class", "node")
            .attr("r", 5)
            .style("fill", function (d) { return color(d.group); })
            .call(cola.drag);

        node.append("title")
            .text(function (d) { return d.name; });

        cola.on("tick", function () {
            link.attr("x1", function (d) { return d.source.x; })
                .attr("y1", function (d) { return d.source.y; })
                .attr("x2", function (d) { return d.target.x; })
                .attr("y2", function (d) { return d.target.y; });

            node.attr("cx", function (d) { return d.x; })
                .attr("cy", function (d) { return d.y; });
        });
    });

}










function draw_net_cy(data) {
	// console.log('draw_net_cy',data);
	all_data = []
	all_data.push(...data.nodes)
	all_data.push(...data.links)
	console.log('all_data',all_data)

	var defaultOptions = {
	  // Called on `layoutready`
	  ready: function () {
	  },
	  // Called on `layoutstop`
	  stop: function () {
	  },
	  // 'draft', 'default' or 'proof" 
	  // - 'draft' fast cooling rate 
	  // - 'default' moderate cooling rate 
	  // - "proof" slow cooling rate
	  quality: 'default',
	  // Whether to include labels in node dimensions. Useful for avoiding label overlap
	  nodeDimensionsIncludeLabels: false,
	  // number of ticks per frame; higher is faster but more jerky
	  refresh: 30,
	  // Whether to fit the network view after when done
	  fit: true,
	  // Padding on fit
	  padding: 10,
	  // Whether to enable incremental mode
	  randomize: true,
	  // Node repulsion (non overlapping) multiplier
	  nodeRepulsion: 4500,
	  // Ideal (intra-graph) edge length
	  idealEdgeLength: 50,
	  // Divisor to compute edge forces
	  edgeElasticity: 0.45,
	  // Nesting factor (multiplier) to compute ideal edge length for inter-graph edges
	  nestingFactor: 0.1,
	  // Gravity force (constant)
	  gravity: 0.25,
	  // Maximum number of iterations to perform
	  numIter: 2500,
	  // Whether to tile disconnected nodes
	  tile: true,
	  // Type of layout animation. The option set is {'during', 'end', false}
	  animate: 'end',
	  // Duration for animate:end
	  animationDuration: 500,
	  // Amount of vertical space to put between degree zero nodes during tiling (can also be a function)
	  tilingPaddingVertical: 10,
	  // Amount of horizontal space to put between degree zero nodes during tiling (can also be a function)
	  tilingPaddingHorizontal: 10,
	  // Gravity range (constant) for compounds
	  gravityRangeCompound: 1.5,
	  // Gravity force (constant) for compounds
	  gravityCompound: 1.0,
	  // Gravity range (constant)
	  gravityRange: 3.8,
	  // Initial cooling factor for incremental layout
	  initialEnergyOnIncremental: 0.5
	};

	var cy = cytoscape({
	  container: document.getElementById('cy'),
	  elements: all_data
	});

	// defaultOptions['name']='cose-bilkent'
	// cy.layout(defaultOptions);

	cy.run();

}







function draw_dynamic_chart(dynamic_data) {

var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height"),
    color = d3.scaleOrdinal(d3.schemeCategory20b);

var a = {id: "a"},
	b = {id: "b"},
	c = {id: "c"},
	d = {id: "d"},
	e = {id: "e"},
	f = {id: "f"},
	g = {id: "g"},
	h = {id: "h"},
	i = {id: "i"},
	j = {id: "j"},
	k = {id: "k"},
	l = {id: "l"},
	m = {id: "m"},
	n = {id: "n"},
	o = {id: "o"},
	p = {id: "p"},
  q = {id: "q"},
	r = {id: "r"},  
  s = {id: "s"},
	t = {id: "t"},
  u = {id: "u"},
  v = {id: "v"},
  w = {id: "w"},
  x = {id: "x"},
  y = {id: "y"},
  z = {id: "z"};
     
 jsonData = [
 {
   "time": 1,
   "node1": a,
   "node2": b
 },
 {
   "time": 2,
   "node1": a,
   "node2": e
 },
 {
   "time": 3,
   "node1": a,
   "node2": d
 },
 {
   "time": 4,
   "node1": b,
   "node2": c
 },
 {
   "time": 5,
   "node1": d,
   "node2": e
 },
 {
   "time": 6,
   "node1": f,
   "node2": g
 },
 {
   "time": 7,
   "node1": p,
   "node2": f
 },
 {
   "time": 8,
   "node1": e,
   "node2": d
 },
 {
   "time": 9,
   "node1": e,
   "node2": f
 },
 {
   "time": 10,
   "node1": f,
   "node2": i
 },
 {
   "time": 11,
   "node1": j,
   "node2": f
 },
 {
   "time": 12,
   "node1": l,
   "node2": g
 },
 {
   "time": 13,
   "node1": i,
   "node2": j
 }, 
 {
   "time": 14,
   "node1": g,
   "node2": h
 },
 {
   "time": 15,
   "node1": o,
   "node2": p
 },
 {
   "time": 16,
   "node1": m,
   "node2": l
 },
 {
   "time": 17,
   "node1": q,
   "node2": r
 },
 {
   "time": 21,
   "node1": q,
   "node2": s
 },
 {
   "time": 22,
   "node1": q,
   "node2": t
 },
 {
   "time": 23,
   "node1": j,
   "node2": k
 },
 {
   "time": 24,
   "node1": j,
   "node2": p
 },
 {
   "time": 25,
   "node1": o,
   "node2": n
 },
 {
   "time": 26,
   "node1": x,
   "node2": x
 },
 {
   "time": 29,
   "node1": p,
   "node2": q
 },
 {
   "time": 30,
   "node1": q,
   "node2": o
 },
 {
   "time": 33,
   "node1": t,
   "node2": u
 },
 {
   "time": 33,
   "node1": x,
   "node2": z
 }  
]
    nodes = [a],
    links = [];
    times = jsonData.map(e => e.time);  // store all the times
  maxtime = d3.max(times);  // get the maximum time to know when to stop
  
  
  
var simulation = d3.forceSimulation(nodes)
    .force("charge", d3.forceManyBody().strength(-300))
    .force("link", d3.forceLink(links).distance(80))
    .force("x", d3.forceX())
    .force("y", d3.forceY())
    .alphaTarget(1)
    .on("tick", ticked);

var g = svg.append("g").attr("transform", "translate(" + width / 2 + "," + height / 2 + ")"),
    link = g.append("g").attr("stroke", "#000").attr("stroke-width", 1.5).selectAll(".link"),
    node = g.append("g").attr("stroke", "#fff").attr("stroke-width", 1.5).selectAll(".node");

restart();

var intervl = setInterval(tickfn,1000),
	counterr = 0;
	
function tickfn(){
	counterr ++;
	if(counterr == maxtime){
		clearInterval(intervl);
	}
	jsonData.forEach(function(jsdata){
		if(counterr == jsdata.time){
			if(!contains(nodes,jsdata.node1)){
				nodes.push(jsdata.node1);
			}
			if(!contains(nodes,jsdata.node2)){
				nodes.push(jsdata.node2);
			}
			links.push({source: jsdata.node1, target: jsdata.node2});
		}
	});
  	d3.select('text').html(counterr);
  	restart();
}

  
  function contains(a, obj) {
    var i = a.length;
    while (i--) {
       if (a[i] === obj) {
           return true;
       }
    }
    return false;
}

  
  
function restart() {

  // Apply the general update pattern to the nodes.
  node = node.data(nodes, function(d) { return d.id;});
  node.exit().remove();
  node = node.enter().append("circle")
    .style('opacity', 1)
    .attr("fill", function(d) { return color(d.id); })
    .attr("r", 8)
    .merge(node)
    ;

  // Apply the general update pattern to the links.
  link = link.data(links, function(d) { return d.source.id + "-" + d.target.id; });
  link.exit().remove();
  link = link.enter().append("line")
       .merge(link);

  // Update and restart the simulation.
  simulation.nodes(nodes);
  simulation.force("link").links(links);
  simulation.alpha(1).restart();
}

  
  
function ticked() {
  node
    .attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; })

  link
    .attr("x1", function(d) { return d.source.x; })
      .attr("y1", function(d) { return d.source.y; })
      .attr("x2", function(d) { return d.target.x; })
      .attr("y2", function(d) { return d.target.y; });
}




}











